<!DOCTYPE html>
<html lang="en">
{% load staticfiles %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>Safety Vote</title>
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400"><!-- Google web font "Open Sans" -->
    <!--link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"-->
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery.ui.css' %}">
    <!-- Main CSS -->
    <link rel="stylesheet" href="{% static 'css/templatemo-style.css' %}"> 
    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <script src="{% static 'js/jquery-ui.min.js' %}"></script>
</head>

<body>
<!--add by liu-->
<div class="navbar navbar-fixed-top custom-navbar" role="navigation">
    <div class="container">
        <!-- NAVBAR HEADER -->
        <div class="navbar-header">
           <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon icon-bar"></span>
                <span class="icon icon-bar"></span>
                <span class="icon icon-bar"></span>
           </button>
           <!-- lOGO -->
           <div class="tm-site-logo"></div>
           <a href="/index" class="tm-text-white"><h1 class="pl-4 tm-site-title">DeliveryGo</h1></a>
        </div>

    <!-- MENU LINKS -->
    <div class="navbar-header">
        <ul class="nav pull-right">
                <li><a href="/index" class="smoothScroll">Home</a></li>
                <!--li><a href="#about" class="smoothScroll">About</a></li-->
                <li><a href="/cityrisk" class="smoothScroll">Risk Analysis</a></li>  
                <li><a href="/rules" class="smoothScroll">Road Rules</a></li>
                <li><a href="/block" class="smoothScroll">Road Closure</a></li>
                <li><a href="/showstar" class="smoothScroll">Safety Vote</a></li>
        </ul>
    </div>
    </div>
</div> 
<!--end by liu -->
		
        <div class="container tm-container-2">
            <div class="row">
                <div class="col-lg-12">
                    <div class="row"><p class="smoothScroll"><a href="/index">Home</a> > <a href="">Safety Vote</a></p></div>  
                    <h2 class="tm-welcome-text">Star the area & share your experience.</h2>
                </div>
            </div>
            <div class="row tm-section-mb">
                <!--search bar -->
                <div class="col-lg-12 mb-5">
                    <form action="/searchstar/" method="POST">{% csrf_token %}
                    <div class="row">
                        <div class="form-group col-xl-4">
                            <input type="text" id="suburb" name="suburb" class="form-control" placeholder="Search Suburb..."/>
                        </div>
                        <div class="form-group col-xl-3">
                            <input type="text" id="postcode" name="postcode" class="form-control" placeholder="Postcode..."/>
                        </div>
						<div class="form-group col-xl-3">
                            <select id="city" name="city" class="select">
                                {% for city in resp.city_list %}
                                    <option value="{{ city.id }}">{{ city.name }}</option>
                                {% endfor %}
							</select>
                        </div>
						<div class="form-group col-xl-2">
                                &nbsp;&nbsp;&nbsp;&nbsp;<button type="submit" class="btn tm-btn-send pull-right">Search It</button>
                        </div>
                    </div>
                    </form>
                </div>
                <!--display search result -->
                {% if resp.suburb_list %}
                <table class="table table-dark">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Suburb Name</th>
                            <th scope="col">Post Code</th>
                            <th scope="col">Affiliated City</th>
                            <th scope="col">Safety Star</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for suburb in resp.suburb_list %}
                        <tr>
                            <th scope="row">{{ suburb.id }}</th>
                            <td>{{ suburb.name }}</td>
                            <td>{{ suburb.postcode }}</td>
                            <td>{{ suburb.city }}</td>
                            <td><div class="star" id="{{ suburb.id }}" rating="{{ suburb.rating }}"></div></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div style="text-align:center"><p>Oops! No suburbs in this result.</p></div>
                {% endif %}
        </div>



            <!--  horizontal line -->
            <hr>
			<div class="row">
				<div class="row tm-section-mb tm-section-mt">
					<div class="col-lg-4 col-md-4 col-sm-12 pr-lg-5 mb-md-0 mb-4">
						<h3 class="mt-2 mb-3 tm-text-gray">AI-based Traffic Warning</h3>
						<p>Integer imperdiet aliquet lobortis. In in metus risus. Pellentesque pulvinar venenatis dui id rutrum.</p>
					</div>
					<div class="col-lg-4 col-md-4 col-sm-12 pr-lg-5 mb-md-0 mb-4">
						<h3 class="mt-2 mb-3 tm-text-gray">Restaurant Recommendation</h3>
						<p>Integer imperdiet aliquet lobortis. In in metus risus. Pellentesque pulvinar venenatis dui id rutrum.</p>
					</div>
					<div class="col-lg-4 col-md-4 col-sm-12">
						<h3 class="mt-2 mb-3 tm-text-gray">The Tip Analysis</h3>
						<p>Integer imperdiet aliquet lobortis. In in metus risus. Pellentesque pulvinar venenatis dui id rutrum.</p>
                </div>
            </div>
        <hr>
        <!-- Footer -->
        <footer class="row mt-5 mb-5">
            <div class="col-lg-12">
                <p class="text-center tm-text-gray tm-copyright-text mb-0">Copyright &copy;
                    <span class="tm-current-year">2018</span> T-Watch Ltd.  | Designer: T-Watch Team
                </p>
            </div>
        </footer>
    </div>
    <!-- .container -->

    <!--Modal start-->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">success</h4>
                </div>
                <div class="modal-body">Thank you for voting!</div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <!--button type="button" class="btn btn-primary">Submit</button-->
                </div>
            </div>
        </div>
    </div>
    <!--Modal end-->

    <script src="{% static 'js/templatemo-script.js' %}"></script>
    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <script src="{% static 'js/jquery.raty.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script>
    $('.star').raty({
	    half: false,
        halfShow: true,
        score: function(){
		    return $(this).attr('rating');
	    },
	    size: 24,
	    starHalf:   '../../static/img/star-half-big.png',
        starOff:    '../../static/img/star-off-big.png',
        starOn:     '../../static/img/star-on-big.png',
	    click: function(score, evt){
            var url='/vote/?id='+$(this).attr('id')+'&score='+score;
            $.ajax({
                   'url': url,
                   'type': 'get',
                   'dataType': 'json',
                   'success': function(json) {
                       if (json.code == 200) {
                        $($(this).attr('id')).raty('score', json.result);
                        $('#myModal').modal('show');
                        $('#myModal').modal('focus');
                       }
                   }
               });
	    }
    });
    </script>
        <style>
                a { color: #FFF; }
                a:hover { 
                    color:#FFF; 
                    text-decoration:none; 
                } 
        </style>

</body>
</html>